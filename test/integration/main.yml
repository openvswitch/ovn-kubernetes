- hosts: all
  become_user: root
  vars_files:
    - "{{ playbook_dir }}/vars.yml"
  tags:
    - setup
  tasks:
    - name: set up the system
      include: system.yml

    - name: install Golang tools
      include: golang.yml
      vars:
        version: "1.9.1"

    - name: clone build and install openshift 
      include: "build/openshift.yml"

    - name: clone build and install kubernetes
      include: "build/kubernetes.yml"

- hosts: all
  vars_files:
    - "{{ playbook_dir }}/vars.yml"
  tags:
    - integration
  tasks:
    - name: clone build and install ovn-kubernetes
      include: "build/ovnkube.yml"
    - name: clone build and install kubernetes
      include: "build/kubernetes.yml"
    - name: run openshift-dind tests
      include: "openshift-dind-test.yml"
